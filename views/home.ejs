<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechSymposium '26 | Home</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body style="background-color: #0f0c29; color: white;">

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg fixed-top glass-nav">
        <div class="container">
            <a class="navbar-brand fw-bold text-white fs-4" href="#">
                <i class="fas fa-atom text-info me-2"></i> TECHSYM '26
            </a>
            <button class="navbar-toggler bg-light" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav align-items-center">
                    <li class="nav-item"><a class="nav-link" href="#hero">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="#events">Events</a></li>
                    
                    <li class="nav-item ms-lg-3">
                        <a href="/logout" onclick="logout()" class="btn btn-sm btn-outline-danger px-3 rounded-pill fw-bold">
                            <i class="fas fa-sign-out-alt me-1"></i> Logout
                        </a>
                    </li>

                    <li class="nav-item">
                        <!-- ID: nav-cta-btn -->
                        <% if (typeof registered !== 'undefined' && registered) { %>
                             <button id="nav-cta-btn" class="btn btn-success ms-lg-3 fw-bold" onclick="viewTicket('<%= typeof event_id !== 'undefined' ? event_id : '' %>')">
                                <i class="fas fa-check-circle me-2"></i>Ticket
                            </button>
                        <% } else { %>
                            <a id="nav-cta-btn" class="btn btn-glow ms-lg-3" href="/register">Register</a>
                        <% } %>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- HERO SECTION -->
    <header id="hero" class="hero-section text-center text-white">
        <div class="container" data-aos="zoom-in" data-aos-duration="1200">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <h5 class="text-uppercase text-info letter-spacing-1 mb-3">Department of IT Presents</h5>
                    <h1 class="glitch-text mb-4">SYMPOSIUM 2026</h1>
                    <p class="lead mb-5 text-white-50">Join the ultimate convergence of code, creativity, and innovation.</p>
                    <div class="d-flex justify-content-center gap-3">
                        <a href="#about" class="btn btn-outline-light rounded-pill px-4 py-2">Learn More</a>
                        
                        <!-- ID: hero-cta-btn -->
                        <% if (typeof registered !== 'undefined' && registered) { %>
                            <button id="hero-cta-btn" onclick="viewTicket('<%= typeof event_id !== 'undefined' ? event_id : '' %>')" class="btn btn-success btn-lg">
                                <i class="fas fa-check-circle me-2"></i>View Ticket
                            </button>
                        <% } else { %>
                            <a id="hero-cta-btn" href="/register" class="btn btn-glow">Register Now</a>
                        <% } %>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- ABOUT SECTION -->
    <section id="about" class="about-section py-5 position-relative">
        <div class="container py-5">
            <div class="row align-items-center">
                <div class="col-lg-6 mb-5 mb-lg-0" data-aos="fade-right">
                    <div class="badge bg-warning text-dark mb-3 px-3 py-2 rounded-pill fw-bold">Dec 26, 2025</div>
                    <h2 class="display-5 fw-bold mb-4">Where Innovation <br> Meets <span class="text-info">Intelligence</span></h2>
                    <p class="text-white-50 lead mb-4">
                        TechSymposium '25 is a national-level technical fest. Compete with the best minds and win cash prizes worth <strong>â‚¹50,000</strong>.
                    </p>
                    <div class="row g-4 mt-2">
                        <div class="col-sm-6">
                            <div class="d-flex align-items-center">
                                <div class="icon-square bg-dark border border-secondary rounded-3 p-3 me-3">
                                    <i class="fas fa-trophy text-warning fa-lg"></i>
                                </div>
                                <div>
                                    <h6 class="mb-0 text-white">Cash Prizes</h6>
                                    <small class="text-white-50">Win Big Rewards</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="d-flex align-items-center">
                                <div class="icon-square bg-dark border border-secondary rounded-3 p-3 me-3">
                                    <i class="fas fa-certificate text-info fa-lg"></i>
                                </div>
                                <div>
                                    <h6 class="mb-0 text-white">Certificates</h6>
                                    <small class="text-white-50">For all Participants</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6" data-aos="fade-left">
                  <img src="/images/about.jpeg" alt="Abouting" class="img-fluid rounded-4 shadow-lg border border-secondary">
                </div>
            </div>
        </div>
    </section>

    <!-- EVENTS SECTION -->
    <section id="events" class="event-section py-5">
        <div class="container py-5">
            <div class="text-center mb-5" data-aos="fade-up">
                <h2 class="fw-bold display-5">Our Events</h2>
                <div class="divider bg-info mx-auto mb-3" style="width: 60px; height: 3px;"></div>
                <p class="text-white-50">Technical & Non-Technical Challenges</p>
            </div>

            <!-- Technical Events -->
            <h3 class="text-info mb-4" data-aos="fade-right"><i class="fas fa-microchip me-2"></i> Technical Events</h3>
            <div class="row g-4 mb-5">
                <div class="col-md-4" data-aos="flip-left" data-aos-delay="100">
                    <div class="custom-card text-center">
                        <i class="fas fa-laptop-code fa-3x card-icon text-primary"></i>
                        <h4>Blind Coding</h4>
                        <p class="text-white-50 small">Type code with your monitor turned off.</p>
                  
                    </div>
                </div>
                <div class="col-md-4" data-aos="flip-left" data-aos-delay="200">
                    <div class="custom-card text-center">
                        <i class="fas fa-bug fa-3x card-icon text-danger"></i>
                        <h4>Bug Smasher</h4>
                        <p class="text-white-50 small">Find and fix bugs in code snippets.</p>
                        
                    </div>
                </div>
                <div class="col-md-4" data-aos="flip-left" data-aos-delay="300">
                    <div class="custom-card text-center">
                        <i class="fas fa-file-powerpoint fa-3x card-icon text-success"></i>
                        <h4>Paper Presentation</h4>
                        <p class="text-white-50 small">Showcase your research on emerging technologies.</p>
                        
                    </div>
                </div>
            </div>

            <!-- Non-Technical Events -->
            <h3 class="text-warning mb-4" data-aos="fade-right"><i class="fas fa-gamepad me-2"></i> Non-Technical Events</h3>
            <div class="row g-4">
                <div class="col-md-4" data-aos="flip-left" data-aos-delay="400">
                    <div class="custom-card text-center">
                        <i class="fas fa-gamepad fa-3x card-icon text-warning"></i>
                        <h4>Gaming</h4>
                        <p class="text-white-50 small">Valorant and BGMI tournaments.</p>
                      
                    </div>
                </div>
                <div class="col-md-4" data-aos="flip-left" data-aos-delay="500">
                    <div class="custom-card text-center">
                        <i class="fas fa-map-marked-alt fa-3x card-icon text-warning"></i>
                        <h4>Treasure Hunt</h4>
                        <p class="text-white-50 small">Solve riddles and find hidden QR codes.</p>
                        
                    </div>
                </div>
                <div class="col-md-4" data-aos="flip-left" data-aos-delay="600">
                    <div class="custom-card text-center">
                        <i class="fas fa-camera fa-3x card-icon text-warning"></i>
                        <h4>Photography</h4>
                        <p class="text-white-50 small">Capture the best moments of the event.</p>
                       
                    </div>
                </div>
            </div>

            <!-- CTA -->
            <div class="text-center mt-5" data-aos="zoom-in">
                <!-- ID: bottom-cta-btn -->
                <% if (typeof registered !== 'undefined' && registered) { %>
                     <button id="bottom-cta-btn" onclick="viewTicket('<%= typeof event_id !== 'undefined' ? event_id : '' %>')" class="btn btn-success px-5 py-3 fs-5">
                        <i class="fas fa-check-circle me-2"></i>View Ticket
                    </button>
                <% } else { %>
                    <a id="bottom-cta-btn" href="/register" class="btn btn-glow px-5 py-3 fs-5">Join The Event</a>
                <% } %>
            </div>
        </div>
    </section>

    <footer class="text-center py-4" style="background: #050508; color: #888;">
        <div class="container">
            <p class="mb-0">&copy; 2025 Department of Information Technology. All Rights Reserved.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script> AOS.init(); </script>

    <!-- ROBUST TICKET REDIRECT SCRIPT -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // 1. Capture ID from URL if present (Server priority)
            const urlParams = new URLSearchParams(window.location.search);
            const serverEventId = urlParams.get('event_id');
            const registered = urlParams.get('registered');

            // 2. Save to Memory if valid
            if (serverEventId && registered === 'true') {
                localStorage.setItem('sympo_event_id', serverEventId);
            }

            // 3. Update buttons based on Memory (Client priority)
            const storedEventId = localStorage.getItem('sympo_event_id');
            if (storedEventId) {
                updateButtonsToTicketMode(storedEventId);
            }
        });

        // The Smart Navigation Function
        function viewTicket(fallbackId) {
            // Priority 1: Check Local Storage
            let targetId = localStorage.getItem('sympo_event_id');

            // Priority 2: Check what the button has (EJS variable)
            if (!targetId && fallbackId && fallbackId.length > 0) {
                targetId = fallbackId;
                // Save it for next time
                localStorage.setItem('sympo_event_id', targetId);
            }

            // Priority 3: Check URL params
            if (!targetId) {
                const urlParams = new URLSearchParams(window.location.search);
                targetId = urlParams.get('event_id');
            }

            if (targetId) {
                // Success: Go to ticket
                window.location.href = `/confirmation?event_id=${targetId}`;
            } else {
                // Failure: No ID found anywhere -> Go to login
                alert("Session expired. Please login again.");
                window.location.href = "/";
            }
        }

        function updateButtonsToTicketMode(eventId) {
            const btnClass = "btn btn-success fw-bold";
            const btnHtml = '<i class="fas fa-check-circle me-2"></i>View Ticket';

            const updateBtn = (id, addClass = "") => {
                const btn = document.getElementById(id);
                if (btn) {
                    // Convert <a> to look and act like the smart button
                    btn.removeAttribute("href"); 
                    btn.className = `${btnClass} ${addClass}`;
                    btn.innerHTML = btnHtml;
                    btn.onclick = function() { viewTicket(eventId); };
                }
            };

            updateBtn("nav-cta-btn", "ms-lg-3");
            updateBtn("hero-cta-btn", "btn-lg");
            updateBtn("bottom-cta-btn", "px-5 py-3 fs-5");
        }

        function logout() {
            localStorage.removeItem('sympo_event_id');
        }
    </script>
</body>
</html>